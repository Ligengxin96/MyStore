<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE hibernate-mapping PUBLIC 
    "-//Hibernate/Hibernate Mapping DTD 3.0//EN"
    "http://www.hibernate.org/dtd/hibernate-mapping-3.0.dtd">
 
<hibernate-mapping>

	<!-- 建立类与表的映射 -->
	<class name="com.learnjava.domain.Customer" table="cst_customer">
	
	<!-- 建立类中的属性与表中的主键映射 -->
	<id name ="cust_id"  column="cust_id" >
		<generator class="native" />
	</id>
	
	<!-- 建立类中的普通的属性和表中的字段的映射 -->
	<property name="cust_name" column="cust_name" />	
	<property name="cust_phone" column="cust_phone" />	
	<property name="cust_mobile" column="cust_mobile" />	
	<property name="cust_image" column="cust_image" />	
	
	<!-- 客户表和字典表多对一的关系 -->
	<many-to-one name="baseDictSource" class="com.learnjava.domain.BaseDict" column="cust_source" />
	<many-to-one name="baseDictIndustry" class="com.learnjava.domain.BaseDict" column="cust_industry" />
	<many-to-one name="baseDictLevel" class="com.learnjava.domain.BaseDict" column="cust_level" />

	<!-- 客户表和联系人表一对多的关系,记得加放弃维护外键权(inverse="true")-->
	<!-- 如果不放弃外键维护权,在修改联系人信息的时候,联系人也是客户的一个属性,延迟加载的问题使得修改完保存的时候联系人属性为空,导致丢失联系人信息 -->
	<set name="linkMans" inverse="true" cascade="delete">
		<key column="lkm_cust_id" ></key>
		<one-to-many class="com.learnjava.domain.LinkMan"/>
	</set>
	
	</class>
</hibernate-mapping>

